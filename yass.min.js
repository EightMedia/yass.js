/*! Yass.js - v0.1.0 - 2014-01-15
 * http://eightmedia.github.io/yass.js/
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
var YASS=function(a,b){function c(a,b,c){var f=this;this.options=b?e(n,b):n,this.callback=c||function(){},this.obj=a,this.candidates=null,this.has_srcset=a.getAttribute(this.options.srcset_attr),a.setAttribute(this.options.yass_attr,!0),this.collectCandidates(),this.update(),d(a,"load",function(){f.show()}),setTimeout(function(){f.show()},500)}function d(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function e(a,b){var c={};for(var d in a)c[d]=b[d]||a[d];return c}function f(){for(var a=b.images,d=0,e=a.length;e>d;d++)a[d].getAttribute(n.srcset_attr)&&!a[d].getAttribute(n.yass_attr)&&l.push(new c(a[d]))}function g(){m={width:a.innerWidth||j.clientWidth||k.width,height:a.innerHeight||j.clientHeight||k.height,density:a.devicePixelRatio||1}}function h(){g();for(var a=0,b=l.length;b>a;a++)l[a].update()}function i(){a.requestAnimationFrame?a.requestAnimationFrame(h):h()}var j=b.documentElement,k=a.screen,l=[],m={},n=e({ready_class:"yass-ready",yass_attr:"data-yass",src_attr:"src",srcset_attr:"srcset",resize_timeout:50},a.YASS_OPTIONS||{});c.prototype={collectCandidates:function(){if(!this.candidates&&this.has_srcset){this.candidates=[];for(var a=this.obj.getAttribute(this.options.srcset_attr),b=a.split(/\s*,\s*/g),c=0;c<b.length;c++){for(var d=b[c].split(" "),e={src:d.shift(),w:0,h:0,x:1},f=0;f<d.length;f++)e[d[f].slice(-1)]=parseFloat(d[f]);this.candidates.push(e)}this.obj.src&&this.candidates.push({src:this.obj[this.options.src_attr],w:0,h:0,x:1}),this.candidates.sort(function(a,b){return a.x>b.x?-1:a.x<b.x?1:a.w>b.w?-1:a.w<b.w?1:a.h>b.h?-1:a.h<b.h?1:1})}},getSrc:function(){var a,b;for(b=0;b<this.candidates.length;b++)if(a=this.candidates[b],a.x<=m.density&&(0===a.w||a.w<m.width)&&(0===a.h||a.h<m.height))return a.src;return a.src},show:function(){-1===this.obj.className.indexOf(this.options.ready_class)&&(this.obj.className+=" "+this.options.ready_class),this.obj.naturalWidth&&(this.obj.width=this.obj.naturalWidth,this.obj.height=this.obj.naturalHeight)},update:function(){if(this.obj.parentNode&&this.has_srcset){var a=this.getSrc();this.obj.getAttribute(this.options.src_attr)!=a&&(this.obj.setAttribute(this.options.src_attr,a),this.callback.call(this,a)),this.show()}}},g(),f();var o;return d(a,"resize",function(){clearTimeout(o),o=setTimeout(i,n.resize_timeout)}),d(a,"orientationchange",i),function(a,b,d){if(a){var e=new c(a,b,d);return l.push(e),e}return f(),i(),l}}(window,document);"undefined"!=typeof module&&module.exports&&(module.exports=YASS);